$(function(){createCode()});var logCode="";function createCode(){logCode=new Array();var c=4;var a=new Array(2,3,4,5,6,7,8,9,"A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","W","X","Y","Z");for(var b=0;b<c;b++){var d=Math.floor(Math.random()*32);logCode+=a[d]}if(logCode.length!=c){createCode()}$("#checkCode").val(logCode)}function logOn(){if(loginValidator()){var e=$("#msg");var b=$("#txtAccount").val();var a=$("#txtPassword").val();var d="<img alt='载入中，请稍候...' height='28' width='28' src='../../images/loading.gif' />";e.html(d);var c={username:encode64(b),password:encode64(a),token:-1};console.log(c);console.log(ws_url+"/rest/user/verify");$.ajax({type:"POST",url:ws_url+"/rest/user/verify",contentType:"application/json;charset=UTF-8",data:JSON.stringify(c),async:false,success:function(f){console.log(f);if(f.status=="success"){e.html("登陆成功");SetCookie("token",f.data.user.token,1);window.location.href=platform_url+"/pages/home/index.html"}else{if(f.message=="error.users.wrong.password"){e.html("密码错误，请重试!")}else{if(f.message=="error.users.name.notexist"){e.html("帐号不存在，请重试!")}else{e.html("登录失败，请重试!")}}}},error:function(f){console.log(f)}})}}function loginValidator(b){var a=true;b=b===undefined?"":b;if(b==""||b=="txtAccount"){if($("#txtAccount").val()==""){$("#msg").html("用户账号不能为空");a=false;return a}else{$("#msg").html("")}}if(b==""||b=="txtPassword"){if($("#txtPassword").val()==""){$("#msg").html("用户密码不能为空");a=false;return a}else{$("#msg").html("")}}if(b==""||b=="txtCode"){if($("#txtCode").val()==""){$("#msg").html("验证码不能为空");a=false;return a}else{if($("#txtCode").val().toUpperCase()!=logCode){$("#msg").html("验证码输入有误");a=false;return a}else{$("#msg").html("")}}}return a}function keySub(a){if(a.keyCode==13){logOn()}};