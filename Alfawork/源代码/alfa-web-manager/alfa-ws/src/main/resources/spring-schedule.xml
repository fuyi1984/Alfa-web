<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd"
       default-lazy-init="true">

    <!--监控订单状态,根据设定的时间范围，自动完成已经确认的订单，每3分钟执行一次-->
    <bean id="MonitorOrderStatusObject" class="com.alfa.web.job.MonitorOrderStatus"/>
    <bean id="MonitorOrderStatusJob"
          class="org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean">
        <property name="targetObject" ref="MonitorOrderStatusObject"/>
        <property name="targetMethod" value="FromConfirmToCompleted"/>
        <property name="concurrent" value="false"/>
    </bean>
    <bean id="MonitorOrderStatusTrigger"
          class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
        <property name="jobDetail" ref="MonitorOrderStatusJob"/>
        <property name="cronExpression" value="0 /3 * * * ?"/>
    </bean>

    <!--监控订单通知短信的状态,每1分钟执行一次-->
    <bean id="MonitorSmsStatusObject" class="com.alfa.web.job.MonitorSmsStatus"/>
    <bean id="MonitorSmsStatusJob"
          class="org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean">
        <property name="targetObject" ref="MonitorSmsStatusObject"/>
        <property name="targetMethod" value="runjob"/>
        <property name="concurrent" value="false"/>
    </bean>
    <bean id="MonitorSmsStatusTrigger"
          class="org.springframework.scheduling.quartz.CronTriggerFactoryBean">
        <property name="jobDetail" ref="MonitorSmsStatusJob"/>
        <property name="cronExpression" value="0 /1 * * * ?"/>
    </bean>

    <bean id="quartzScheduler" class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
        <property name="waitForJobsToCompleteOnShutdown" value="true"/>
        <property name="triggers">
            <list>
                <!--<ref bean="cronTrigger"/>-->
                <ref bean="MonitorSmsStatusTrigger"/>
                <ref bean="MonitorOrderStatusTrigger"/>
            </list>
        </property>
        <property name="quartzProperties">
            <props>
                <prop key="org.quartz.scheduler.skipUpdateCheck">true</prop>
            </props>
        </property>
    </bean>

</beans>